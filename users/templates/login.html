{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Login - Gold Cinema</title>

  <!-- Correct Django static reference -->
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
  <link rel="stylesheet" href="{% static 'css/loader.css' %}">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>

<body>
  {% include 'includes/loader.html' %}
  <div class="container">
    <div class="login-box">

      <!-- Django correct home link -->
      <a href="/" class="back-link">‚Üê Back</a>

      <h2>Login</h2>
      {% if messages %}
      <div class="messages">
        {% for message in messages %}
        <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Correct login form -->
      <form id="loginForm" action="{% url 'login' %}" method="POST">
        {% csrf_token %}

        <label for="email">Email Address</label>
        <input type="email" id="email" name="email" placeholder="e.g. alphez@gmail.com" required />

        <label for="password">Password</label>
        <div class="password-container">
          <input type="password" id="password" name="password" placeholder="Enter password" required
            class="password-input" />
          <span class="password-toggle" id="togglePassword">üôà</span>
        </div>

        <button class="button" type="submit">Login</button>

        <span class="cta">
          Don't have an account?
          <a href="{% url 'register' %}" style="text-decoration: underline;">Register Here</a>
        </span>

        <span class="cta">
          <a href="{% url 'password_reset_request' %}" style="text-decoration: underline;">Forgot Password?</a>
        </span>
      </form>

    </div>
  </div>

  <script>
    const form = document.getElementById("loginForm");

    form.addEventListener("submit", function (e) {
      const email = form.email.value.trim();
      const password = form.password.value.trim();

      // Only prevent default if validation fails
      if (!email || !password) {
        alert("‚ùå Please fill in all fields!");
        e.preventDefault();
        return false;
      }

      // If validation passes, let the form submit normally
      // Don't call e.preventDefault() for successful validation
      return true;
    });

    // Password toggle functionality
    document.getElementById('togglePassword').addEventListener('click', function () {
      const passwordInput = document.getElementById('password');
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);

      // Optional: Change the emoji
      this.textContent = type === 'password' ? 'üôà' : 'üôâ';
    });
  </script>

</body>

</html>